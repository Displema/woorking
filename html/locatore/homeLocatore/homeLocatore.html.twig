<!DOCTYPE html>
<html lang="it" data-bs-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Home - Cooworking</title>
  <!-- Tabler CSS -->
  <link href="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0/dist/css/tabler.min.css" rel="stylesheet">
  <!-- CSS Personalizzato -->
  <link href="/html/locatore/homeLocatore/homeLocatore.css" rel="stylesheet">
  <!-- FontAwesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  
    <!-- Creo la navbar -->
    {% include '/locatore/navbar/NavBarLocatore.html.twig' %}


  <!-- Contenuto principale -->
  <div class="page-wrapper main-content">

    <!-- Header con titolo e profilo -->
    <header class="page-header d-flex flex-column flex-md-row justify-content-between align-items-center p-4">
  <!-- Titolo -->
  <div class="flex-grow-1 text-center text-md-start mb-3 mb-md-0">
    <h1 class="welcome-title">Bentornato in Cooworking</h1>



  </div>
  <!-- Profilo utente -->
  <div class="dropdown">
    <a href="#" class="d-flex align-items-center text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
      <div class="avatar rounded-circle bg-primary text-white d-flex align-items-center justify-content-center shadow" style="width: 3rem; height: 3rem;">
        <i class="fas fa-user fs-4"></i>
      </div>
    </a>
    <ul class="dropdown-menu dropdown-menu-end shadow rounded-3 mt-2">
      <li><a class="dropdown-item d-flex align-items-center" href="/profilo"><i class="fas fa-user me-2 text-primary"></i> Profilo</a></li>
      <li><a class="dropdown-item d-flex align-items-center" href="#"><i class="fas fa-cog me-2 text-secondary"></i> Impostazioni</a></li>
      <li><hr class="dropdown-divider"></li>
      <li><a class="dropdown-item d-flex align-items-center text-danger" href="/logout"><i class="fas fa-sign-out-alt me-2"></i> Logout</a></li>
    </ul>
  </div>
</header>

    <!-- Contenuto della pagina -->
     <!--Introduzione della pagina-->
    <div class="page-body">
      <div class="container bg-light rounded p-4 my-4">
  <p class="lead text-center">Questa √® la tua area riservata per gestire gli spazi di coworking.</p>
  <p class="lead text-center">Qui potrai aggiungere nuovi uffici, gestire al meglio le prenotazioni ricevute e rimuovere uffici vecchi che non servono pi√π.</p>
  <p class="lead text-center">Infine puoi controllare quando e come vuoi le tue statistiche in quanto locatore, cos√¨ da essere sempre aggiornato sull'andamento.</p>
</div>
    </div>

<!-- Sezione Grafici -->
 <div class="container my-5">
  <!-- Entrate Mensili -->
    <div class="card mb-5 shadow border-0 rounded-4 bg-light-subtle">
      <div class="card-body p-5">
        <h2 class="text-center fw-bold mb-3 text-primary fs-1">üìä Entrate Mensili</h2>
        <p class="text-center text-muted fs-5 mb-4">
        Monitora l'andamento delle entrate generate dai tuoi uffici nel tempo per avere una visione chiara della tua crescita economica.
       </p>
         <div class="text-center">
           <div style="max-width: 600px; height: 400px; margin: auto;">
               <canvas id="graficoEntrate" style="width: 100%; height: 100%;"></canvas>
            </div>
         </div>

      </div>

  </div>

  <!-- Utilizzo Uffici -->
  <div class="card mb-5 shadow border-0 rounded-4 bg-light-subtle">
    <div class="card-body p-5">
      <h2 class="text-center fw-bold mb-3 text-success fs-1">üè¢ Utilizzo degli Uffici</h2>
      <p class="text-center text-muted fs-5 mb-4">
        Visualizza quanto frequentemente vengono prenotati i tuoi uffici, per ottimizzare la gestione degli spazi disponibili.
      </p>
      <div class="text-center">
        <div class="d-flex justify-content-center align-items-center" style="min-height: 400px;">
          <div style="max-width: 500px; width: 100%;">
            <canvas id="graficoUtilizzo"></canvas>
          </div>
        </div>


      </div>
    </div>
  </div>

  <!-- Recensioni -->
  <div class="card mb-5 shadow border-0 rounded-4 bg-light-subtle">
    <div class="card-body p-5">
      <h2 class="text-center fw-bold mb-3 text-warning">üåü Recensioni e Feedback</h2>
      <p class="text-center text-muted fs-5 mb-4">
        Tieni traccia della soddisfazione dei tuoi utenti tramite le recensioni ricevute, cos√¨ da offrire sempre un servizio migliore.
      </p>
      <div class="text-center">
        <img src="images/images.jpg" class="img-fluid rounded" alt="Grafico Recensioni">
      </div>
    </div>
  </div>
</div>

  <!-- Tabler JS -->
  <script src="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0/dist/js/tabler.min.js"></script>

    <canvas id="graficoEntrate"></canvas>
    <script>
      fetch('/api/grafici/entrate-mensili')
              .then(res => res.json())
              .then(data => {
                const mesi = data.map(e => e.mese);
                const entrate = data.map(e => e.entrate);

                new Chart(document.getElementById('graficoEntrate'), {
                  type: 'bar',
                  data: {
                    labels: mesi,
                    datasets: [{
                      label: 'Entrate (‚Ç¨)',
                      data: entrate,
                      backgroundColor: 'rgba(54, 162, 235, 0.7)', // colore barre
                      borderColor: 'rgba(54, 162, 235, 1)',       // bordo barre
                      borderWidth: 1,
                      borderRadius: 5                            // arrotonda gli angoli delle barre
                    }]
                  },
                  options: {
                    responsive: true,
                    scales: {
                      y: {
                        beginAtZero: true,
                        ticks: {
                          callback: value => '‚Ç¨ ' + value.toLocaleString()  // formato valuta sull'asse Y
                        }
                      }
                    }
                  }
                });
              });
    </script>
    <canvas id="graficoUtilizzo"></canvas>
    <script>
      fetch('/api/grafici/utilizzo-uffici')
              .then(res => res.json())
              .then(data => {
                const nomiUffici = data.map(e => e.nome);
                const utilizzi = data.map(e => e.numeroPrenotazioni);

                new Chart(document.getElementById('graficoUtilizzo'), {
                  type: 'pie',
                  data: {
                    labels: nomiUffici,
                    datasets: [{
                      label: 'Prenotazioni',
                      data: utilizzi,
                      backgroundColor: [
                        'rgba(255, 99, 132, 0.7)',
                        'rgba(54, 162, 235, 0.7)',
                        'rgba(255, 206, 86, 0.7)',
                        'rgba(75, 192, 192, 0.7)',
                        'rgba(153, 102, 255, 0.7)',
                        'rgba(255, 159, 64, 0.7)'
                      ],
                      borderColor: 'white',
                      borderWidth: 1
                    }]
                  },
                  options: {
                    responsive: true,
                    plugins: {
                      legend: {
                        position: 'bottom'
                      },
                      tooltip: {
                        callbacks: {
                          label: function(context) {
                            const label = context.label || '';
                            const value = context.parsed;
                            return `${label}: ${value} prenotazioni`;
                          }
                        }
                      }
                    }
                  }
                });
              })
              .catch(err => console.error("Errore nel fetch del grafico:", err));


    </script>



  </div>
</body>
</html>